version: '3'
services:
  loki:
    user: 1000:1000
    image: grafana/loki:$LOKI_VERSION
    container_name: loki    
    ports:
      - 3100:3100
    volumes:
      - ./config-loki:/mnt/config
      - ./data:/loki
    command: -config.file=/mnt/config/loki-config.yml
    networks:
      - default
      
  promtail:
    image: grafana/promtail:$PROMTAIL_VERSION
    container_name: promtail    
    ports:
      - 1514:1514
    volumes:
      - ./config-promtail:/mnt/config
      - /var/log:/var/log
      - /var/run/docker.sock:/var/run/docker.sock
    command: -config.file=/mnt/config/promtail-config.yml
    networks:
      - default
